---
title: "Baun Welch using another library"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

```{r}
states <- c("Begin", "s", "t")
observation <- c("A", "B")
### Define transition probability matrix A
A <- matrix(c(0, 0.85, 0.15, 0, 0.3, 0.7, 0, 0.1, 0.9), byrow = T, nrow = 3)
dimnames(A) <- list(from = states, to = states)
### Define emission probability matrix E
E <- matrix(c(0.4, 0.6, 0.5, 0.5), byrow = T, nrow=2)
dimnames(E) <- list(states = states[-1], observation = observation)
### Create the HMM object
x <- structure(list(A = A, E = E), class = "HMM")
x$A
x$E
```
```{r}
sim1 <- aphid::generate(x, 1000)
hidden1 <- names(sim1)
cbind(hidden1, sim1)
table(hidden1, sim1)
```

```{r}
hmm <- train(x, c("A", "B", "B", "A"), method = "BaumWelch", seqweights = NULL, maxiter = 32, pseudocounts = "none")
hmm$A
hmm$E

#A <- matrix(c(0, 0.82584825, 0.1741517, 0, 0.33005013, 0.6699499, 0, 0.09871229, 0.9012877), byrow = T, nrow = 3)
#dimnames(A) <- list(from = states, to = states)
### Define emission probability matrix E
#E <- matrix(c(0.6584505, 0.3415495, 0.4122485, 0.5877515), byrow = T, nrow=2)
#dimnames(E) <- list(states = states[-1], observation = observation)
### Create the HMM object
#x <- structure(list(A = A, E = E), class = "HMM")
#hmm <- train(x, c("A", "B", "B", "A"), method = "BaumWelch", seqweights = NULL,
 #            maxiter = 1, pseudocounts = "none")
#hmm$A
#hmm$E
```
```{r}
states <- c("Begin", "s", "t")
observation <- c("A", "B")
### Define transition probability matrix A
A <- matrix(c(0,0.5, 0.5, 0, 0.5, 0.5, 0, 0.5, 0.5), byrow = T, nrow = 3)
dimnames(A) <- list(from = states, to = states)
### Define emission probability matrix E
E <- matrix(c(0.5, 0.5, 0.5, 0.5), byrow = T, nrow=2)
dimnames(E) <- list(states = states[-1], observation = observation)
### Create the HMM object
x <- structure(list(A = A, E = E), class = "HMM")
x$A
x$E
hmm <- train(x, sim1, method = "BaumWelch", seqweights = NULL, deltaLL = 0.00001, pseudocounts = "none", quiet = TRUE)
hmm$A
hmm$E

```


